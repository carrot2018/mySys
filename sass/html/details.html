<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>details</title>
    <link rel="stylesheet" href="../../iconfont/iconfont.css">
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/details.css">

</head>

<body>
    <div id="top-nav">
        <div class="container">
            <div class="top-nav-left">

                <a class="welcome" href="../index.html">欢迎来到aniToys</a>

                <a id="login" href="login.html">请登录</a>

                <a id="register" href="register.html">免费注册</a>

            </div>
            <div class="top-nav-right">
                <ul>
                    <li>
                        <a href="">站内信</a>
                    </li>
                    <li class="myOrder">
                        <a href="">我的订单
                            <i class="iconfont icon-xiaosanjiaodown"></i>
                        </a>
                        <ul>
                            <li>
                                <a href="">代补款订单</a>
                            </li>
                            <li>
                                <a href="">已发货订单</a>
                            </li>
                            <li>
                                <a href="">售后订单</a>
                            </li>
                            <li>
                                <a href="">历史订单</a>
                            </li>
                        </ul>

                    </li>
                    <li class="myAnitoys">
                        <a href="">我的aniToys
                            <i class="iconfont icon-xiaosanjiaodown"></i>
                        </a>
                        <ul>
                            <li>
                                <a href="">代补款订单</a>
                            </li>
                            <li>
                                <a href="">已发货订单</a>
                            </li>
                            <li>
                                <a href="">售后订单</a>
                            </li>
                            <li>
                                <a href="">历史订单</a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="">联系客服</a>
                    </li>
                    <li>
                        <a href="">旧版补款入口</a>
                    </li>
                    <li class="followUs">
                        <a href="">关注我们
                            <i class="iconfont icon-xiaosanjiaodown"></i>
                        </a>
                        <ul>
                            <li>
                                <a href="">代补款订单</a>
                            </li>
                            <li>
                                <a href="">已发货订单</a>
                            </li>
                            <li>
                                <a href="">售后订单</a>
                            </li>
                            <li>
                                <a href="">历史订单</a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <!-- 头部信息栏 -->
    <div id="header">
        <div class="container">
            <div class="banner">
                <div id="search">
                    <form action="" method="post">
                        <i class="iconfont icon-magnifier"></i>
                        <input type="text" name="" id="" placeholder="请输入关键字">
                        <a href=" " id="clickSearch">搜索</a>
                    </form>
                    <ul id="hotSearch">
                        <li>热门搜索：</li>
                        <li>
                            <a href="">Fate系列</a>
                        </li>
                        <li>
                            <a href="">守望先锋</a>
                        </li>
                        <li>
                            <a href="">初音未来</a>
                        </li>
                        <li>
                            <a href="">全职高手</a>
                        </li>
                        <li>
                            <a href="">刀剑乱舞</a>
                        </li>
                        <li>
                            <a href="">精灵宝可梦</a>
                        </li>
                    </ul>
                </div>

                <div class="shoppingCart">
                    <i class="iconfont icon-gouwuche"></i>
                    <a href="shopping.html">去购物车结算</a>
                    <div class="shopping-num">0</div>
                </div>


            </div>
        </div>
    </div>
    <div id="nav">
        <div class="container">

            <div class="nav-link-header">
                <span>
                    <a class="alltoys" href="">所有周边</a>
                    <div class="nav-list">
                        <ul id="navbg">
                            <li class="navLi">
                                <div class="navLi-content">
                                    <a href="">
                                        <i>|</i>手办/模型/玩偶</a>
                                </div>
                                <div class="navLi-list">
                                    <div class="navLi-list-item">
                                        <div class="navLi-list-title">手办</div>
                                        <ul>
                                            <li>
                                                <a href="">粘土人</a>
                                                <i>|</i>
                                            </li>
                                            <li>
                                                <a href="">粘土人</a>
                                                <i>|</i>
                                            </li>
                                            <li>
                                                <a href="">粘土人</a>
                                                <i>|</i>
                                            </li>
                                            <li>
                                                <a href="">粘土人</a>
                                                <i>|</i>
                                            </li>
                                            <li>
                                                <a href="">粘土人</a>

                                            </li>
                                        </ul>
                                    </div>
                                    <div class="navLi-list-item">
                                        <div class="navLi-list-title">手办</div>
                                        <ul>
                                            <li>
                                                <a href="">粘土人</a>
                                                <i>|</i>
                                            </li>
                                            <li>
                                                <a href="">粘土人</a>
                                                <i>|</i>
                                            </li>
                                            <li>
                                                <a href="">粘土人</a>
                                                <i>|</i>
                                            </li>

                                            <li>
                                                <a href="">粘土人</a>

                                            </li>
                                    </div>
                                    <div class="navLi-list-item">
                                        <div class="navLi-list-title">手办</div>
                                        <ul>
                                            <li>
                                                <a href="">粘土人</a>
                                                <i>|</i>
                                            </li>
                                            <li>
                                                <a href="">粘土人</a>
                                                <i>|</i>
                                                <li>
                                                    <a href="">粘土人</a>

                                                </li>
                                    </div>
                                </div>
                                </li>
                                <li class="navLi">
                                    <div class="navLi-content">

                                        <a href="">
                                            <i>|</i>角色周边/文具办公/日用家居
                                        </a>
                                    </div>
                                    <div class="navLi-list">
                                        <div class="navLi-list-item">
                                            <div class="navLi-list-title">手办</div>
                                            <ul>
                                                <li>
                                                    <a href="">粘土人</a>
                                                    <i>|</i>
                                                </li>
                                                <li>
                                                    <a href="">粘土人</a>
                                                    <i>|</i>
                                                </li>
                                                <li>
                                                    <a href="">粘土人</a>
                                                    <i>|</i>
                                                </li>
                                                <li>
                                                    <a href="">粘土人</a>
                                                    <i>|</i>
                                                </li>
                                                <li>
                                                    <a href="">粘土人</a>

                                                </li>
                                            </ul>
                                        </div>
                                        <div class="navLi-list-item">
                                            <div class="navLi-list-title">手办</div>
                                            <ul>
                                                <li>
                                                    <a href="">粘土人</a>
                                                    <i>|</i>
                                                </li>
                                                <li>
                                                    <a href="">粘土人</a>
                                                    <i>|</i>
                                                </li>
                                                <li>
                                                    <a href="">粘土人</a>
                                                    <i>|</i>
                                                </li>

                                                <li>
                                                    <a href="">粘土人</a>

                                                </li>
                                        </div>
                                        <div class="navLi-list-item">
                                            <div class="navLi-list-title">手办</div>
                                            <ul>
                                                <li>
                                                    <a href="">粘土人</a>
                                                    <i>|</i>
                                                </li>
                                                <li>
                                                    <a href="">粘土人</a>
                                                    <i>|</i>
                                                </li>
                                                <li>
                                                    <a href="">粘土人</a>
                                                </li>
                                        </div>
                                    </div>
                                </li>
                                <li class="navLi">
                                    <div class="navLi-content">

                                        <a href="">
                                            <i>|</i>演出票务/官方周边</a>
                                    </div>
                                    <div class="navLi-list">
                                        <div class="navLi-list-item">
                                            <div class="navLi-list-title">手办</div>
                                            <ul>
                                                <li>
                                                    <a href="">粘土人</a>
                                                    <i>|</i>
                                                </li>
                                                <li>
                                                    <a href="">粘土人</a>
                                                    <i>|</i>
                                                </li>
                                                <li>
                                                    <a href="">粘土人</a>
                                                    <i>|</i>
                                                </li>
                                                <li>
                                                    <a href="">粘土人</a>
                                                    <i>|</i>
                                                </li>
                                                <li>
                                                    <a href="">粘土人</a>

                                                </li>
                                            </ul>
                                        </div>
                                        <div class="navLi-list-item">
                                            <div class="navLi-list-title">手办</div>
                                            <ul>
                                                <li>
                                                    <a href="">粘土人</a>
                                                    <i>|</i>
                                                </li>
                                                <li>
                                                    <a href="">粘土人</a>
                                                    <i>|</i>
                                                </li>
                                                <li>
                                                    <a href="">粘土人</a>
                                                    <i>|</i>
                                                </li>

                                                <li>
                                                    <a href="">粘土人</a>

                                                </li>
                                        </div>
                                        <div class="navLi-list-item">
                                            <div class="navLi-list-title">手办</div>
                                            <ul>
                                                <li>
                                                    <a href="">粘土人</a>
                                                    <i>|</i>
                                                </li>
                                                <li>
                                                    <a href="">粘土人</a>
                                                    <i>|</i>
                                                </li>
                                                <li>
                                                    <a href="">粘土人</a>
                                                </li>
                                        </div>
                                    </div>
                                </li>
                                <li class="navLi">
                                    <div class="navLi-content">

                                        <a href="">
                                            <i>|</i>其他</a>
                                    </div>
                                    <div class="navLi-list">
                                        <div class="navLi-list-item">
                                            <div class="navLi-list-title">服务</div>
                                            <ul>
                                                <li>费用
                                                    <i>|</i>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </li>
                                <li class="navLi">
                                    <div class="navLi-content">

                                        <a href="">
                                            <i>|</i>更多</a>
                                    </div>
                                </li>
                                </ul>
                    </div>
                </span>
            </div>
            <div class="nav-link-list">
                <a class="home" href="">首页</a>
                <a href="">旧版补款入口</a>
                <a href="">新品预售</a>
                <a href="">现货</a>
                <a href="">优惠券</a>
            </div>

        </div>
    </div>
    <!-- 主内容区 -->
    <div id="main">
        <div class="container">
            <div class="main-nav">
                <a href="">手办/模型/玩偶</a>
                <span>&nbsp;>&nbsp;手办&nbsp;></span>
                <a href="">粘土人</a>
                <a href="" class="kind">Good Smile Company</a>&nbsp;>&nbsp;
                <span class="name">粘土人 哈利波特（附特典）</span>

            </div>
            <div class="main-content">

                <div id="slider">
                    <div id="big-show">
                        <img src="../../images/show1.jpg" id="img1">
                    </div>
                    <div id="slider-show">

                        <div id="slider-show-img">
                            <div id="mask" style="display: none"></div>
                            <img src="../../images/show1.jpg" alt="">
                        </div>

                    </div>
                    <div class="slider-thumb">
                        <div class="next-group" style="display: block">
                            <i class="iconfont icon-iconfontzhizuobiaozhun023127"></i>
                        </div>
                        <div class="pre-group" style="display: none">
                            <i class="iconfont icon-iconfontzhizuobiaozhun023126"></i>
                        </div>
                        <div class="thumb-wrap">
                            <ul class="thumb-box">
                                <li class="active">
                                    <img class="show1" src="../../images/show1.jpg" alt="">
                                </li>
                                <li>
                                    <img class="show2" src="../../images/show2.jpg" alt="">
                                </li>
                                <li>
                                    <img class="show3" src="../../images/show3.jpg" alt="">
                                </li>
                                <li>
                                    <img class="show4" src="../../images/show4.jpg" alt="">
                                </li>
                                <li>
                                    <img class="show5" src="../../images/show5.jpg" alt="">
                                </li>
                                <li>
                                    <img class="show6" src="../../images/show6.jpg" alt="">
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="pro-like">
                        <i class="iconfont icon-02"></i>
                        <a href="">收藏商品</a>
                        <div class="more">
                            <a href="">更多</a>
                        </div>
                    </div>
                </div>
                <div class="box-price">
                    <div class="price-content">
                        <form action="" method="post">
                            <div class="price-detail">
                                <div class="details-title">
                                    <h1>
                                        <em>预售</em>
                                        <span class="title name">粘土人 哈利波特（附特典）</span>
                                    </h1>
                                    <p class="word">呼神护卫！</p>
                                </div>
                                <div class="summary">
                                    <ul>
                                        <li>
                                            <p>商品状态：</p>
                                            <span>预售已开始</span>
                                        </li>
                                        <li>
                                            <p>价格：</p>
                                            <span class="price">¥269.00</span>
                                        </li>
                                        <li>
                                            <p>定金：</p>
                                            <span class="earnest">¥50.00</span>
                                        </li>
                                    </ul>
                                </div>
                                <div class="choose">
                                    <div class="choose-kind">
                                        <p class="dt">种类:</p>
                                        <span class="dd presell">预售</span>
                                    </div>
                                    <div class="choose-buy">
                                        <p class="dt">购买数量:</p>
                                        <span class="dd buy">
                                            <a href="" class="add" onclick="return false">
                                                <i class="iconfont icon-jiantou_up"></i>
                                            </a>
                                            <a href="" class="subtract" onclick="return false">
                                                <i class="iconfont icon-jiantou_down"></i>
                                            </a>
                                            <input class="buy-input" type="number" min="1" max="9999" value="1">
                                        </span>
                                    </div>
                                    <div class="choose-num">
                                        <p class="dt">您已选择:</p>
                                        <span class="dd">
                                            <em class="num">1</em>件
                                        </span>
                                    </div>
                                    <div class="btn">
                                        <a href="" class="buynow">
                                            <span>立即购买</span>
                                        </a>
                                        <a href="javascript:void(0);" class="add-shoppingCart">
                                            <span>加入购物车</span>
                                        </a>
                                    </div>
                                </div>
                            </div>

                        </form>
                        <ul class="seller">
                            <li>
                                卖家：
                                <a href="">GoodSmile上海阿尼托官方旗舰店</a>
                            </li>
                            <li>
                                <div class="service">联系客服：</div>
                                <div class="help">
                                    <a href="" class="qqRelation">
                                        <img src="../../images/qq (1).jpg" alt="">
                                    </a>
                                </div>
                            </li>
                            <li>
                                <div class="btn-wrap">
                                    <div>
                                        <a href="">进入店铺</a>
                                    </div>
                                    <div>
                                        <a href="">收藏店铺</a>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

</html>
<script src="../../js/jquery.min.js"></script>
<script>
    //获取用户名
    if (window.localStorage.getItem("name")) {
        $(".welcome").html(window.localStorage.getItem('name'))
        $("#login").css("display", "none");
        $("#register").html("注销").attr("href", "../index.html");
        $("#register").click(function () {
            localStorage.removeItem("name");
        });
    };

    //保存当前用户加入购物车的商品和数量
    $(".add-shoppingCart").click(function () {
        var num = Number($(".buy-input").val());
        // console.log(num);
        // console.log(typeof (num));
        var bid = location.search.split("=")[1];
        var obj = [
            { "bid": bid, "count": num }
        ];
        var objStr = JSON.stringify(obj);
        if (!localStorage.getItem($(".welcome").html() + "Goods")) {
            //当localStorage里面没有任何购物车信息，需要添加何购物车信息
            localStorage.setItem($(".welcome").html() + "Goods", objStr);
        } else {
            //当localStorage里面已经存在购物车信息，要判断当前点击的bid的这个商品在信息里是否存在 
            //如果有，在原来商品数量上加1，如果没有，重新在原来localStorage基础上追加1个商品
            var cartGoods = localStorage.getItem($(".welcome").html() + "Goods");
            var cartGoodsJson = JSON.parse(cartGoods);
            //一个控制器，用户判断原来的购物车信息中是否存在当前的这个bid商品
            var flag = false;//false表示购物车信息中是没有当前的这个bid商品
            for (var i = 0; i < cartGoodsJson.length; i++) {
                if (cartGoodsJson[i].bid == bid) {
                    cartGoodsJson[i].count += num;
                    flag = true;//true表示购物车信息中已经存在当前的这个bid商品
                }
            }
            if (!flag) {//购物车信息中是没有当前的这个bid商品
                //追加一条
                var newBidInfo = { "bid": bid, "count": num };
                cartGoodsJson.push(newBidInfo);
            }
            //添加到localStorage中
            var cartGoodsJsonToStr = JSON.stringify(cartGoodsJson);
            localStorage.setItem($(".welcome").html() + "Goods", cartGoodsJsonToStr);

        }
        getCartCount();

    });
    getCartCount();
    //计算购物车商品总条数
    function getCartCount() {
        //购物车信息存在，就可以来计算条数了
        if (localStorage.getItem($(".welcome").html() + "Goods")) {

            var cartGoods = localStorage.getItem($(".welcome").html() + "Goods");
            var cartGoodsJson = JSON.parse(cartGoods);
            //
            var sum = 0;
            for (var i = 0; i < cartGoodsJson.length; i++) {
                sum += Number(cartGoodsJson[i].count);
            }

            $(".shopping-num").html(sum);
        } else {
            return;
        }
    }

    //渲染
    var bid = window.location.search.split("=")[1];
    $.ajax({
        type: "post",
        url: "../php/details.php",
        data: {
            bid: bid
        },
        success: function (res) {

            var obj = JSON.parse(res);
            $("#big-show img").attr({ src: obj.src1 }),
                $("#slider-show img").attr({ src: obj.src1 }),
                $(".show1").attr({ src: obj.src1 }),
                $(".show2").attr({ src: obj.src2 }),
                $(".show3").attr({ src: obj.src3 }),
                $(".show4").attr({ src: obj.src4 }),
                $(".show5").attr({ src: obj.src5 }),
                $(".show6").attr({ src: obj.src6 }),
                $(".word").html(obj.word),
                $(".price").html(obj.price),
                $(".earnest").html(obj.earnest),
                $(".kind").html(obj.kind),
                $(".name").html(obj.name)
        }
    });

    //下拉列表的背景颜色
    $("#navbg>.navLi").mouseenter(function () {
        var arr = ["#fdd053", "#e65c00", "#64abea", "#b081d3", "#4bccad"];
        $(this).css("background", arr[$(this).index()]).siblings().css("background", "#f5f5f5");
    });
    $("#navbg>.navLi").mouseleave(function () {
        $(this).css("background", "#f5f5f5");
    });

    //图片滚动
    $(".next-group").click(function () {
        $(".thumb-box").stop().animate({ left: "-336px" }, 500);
        $(".pre-group").css("display", "block");
        $(this).css("display", "none");
    });
    $(".pre-group").click(function () {
        $(".thumb-box").stop().animate({ left: "0" }, 500);
        $(".next-group").css("display", "block");
        $(this).css("display", "none");
    });

    //图片显示
    $(".thumb-box>li").mouseenter(function () {
        $(this).addClass("active").siblings().removeClass("active");
        $("#slider-show-img>img").attr("src", $(".active img").attr("src"));

    });
    $("#slider-show-img").mouseover(function () {
        $("#big-show").css("display", "block");
        $("#img1").attr("src", $(".active img").attr("src"));
        $("#mask").css("display", "block");
    });

    $("#slider-show-img").mouseleave(function () {
        $("#big-show").css("display", "none");
        $("#mask").css("display", "none");
    });
    //放大镜
    var showImg = document.getElementById("slider-show-img");
    var slider = document.getElementById("slider");
    var mask = document.getElementById("mask");
    var bigShow = document.getElementById("img1");
    var big = document.getElementById("big-show");
    slider.onmousemove = function (e) {
        var e = e || event;
        var l = e.pageX - slider.offsetLeft - mask.offsetWidth / 2;
        var t = e.pageY - slider.offsetTop - mask.offsetHeight / 2;

        var left = showImg.clientWidth - mask.offsetWidth;
        var top = showImg.clientHeight - mask.offsetHeight;
        l = l < 0 ? 0 : (l > left ? left : l);
        t = t < 0 ? 0 : (t > top ? top : t);
        mask.style.left = l + "px";
        mask.style.top = t + "px";
        var bigImgL = l * bigShow.offsetWidth / showImg.offsetWidth;
        var bigImgT = t * bigShow.offsetHeight / showImg.offsetHeight;
        bigShow.style.left = -bigImgL + "px";
        bigShow.style.top = -bigImgT + "px";
    }

    //商品数量
    var i = 1;
    $(".add").click(function () {
        i++;
        var num = Number($(".buy-input").html()) + i;
        $(".buy-input").attr("value", num);
        $(".num").html(i);
    });
    $(".subtract").click(function () {
        i--;
        var num = Number($(".buy-input").html()) + i;
        if (i == 0) {
            i = 1;
        }
        $(".buy-input").attr("value", num);
        $(".num").html(i);
    });


</script>